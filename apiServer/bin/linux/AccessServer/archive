BASH=/bin/bash

echo 'start'

WORKPATH=/tmp/${USER}
mkdir -p ${WORKPATH}

WORKSPACE=${WORKPATH}/accessServer

rm -rf ${WORKSPACE}/
mkdir  ${WORKSPACE}
mkdir ${WORKSPACE}/bin
mkdir ${WORKSPACE}/config
mkdir ${WORKSPACE}/lib
mkdir ${WORKSPACE}/doc

cp -rf bin/accessServer ${WORKSPACE}/bin/
cp -rf config/log.property ${WORKSPACE}/config/
cp -rf config/sys.cfg ${WORKSPACE}/config/
cp -rf config/whiteRoomList.json ${WORKSPACE}/config/
cp -rf config/relayRoom.json ${WORKSPACE}/config/
cp -rf config/allowRoom.json ${WORKSPACE}/config/
cp -rf config/encoding.json ${WORKSPACE}/config/
cp -rf check_exist.sh ${WORKSPACE}/
cp -rf doc/*.docx ${WORKSPACE}/doc

cp /home/3rd-party/log4cxx/lib/liblog4cxx.so.10 ${WORKSPACE}/lib
cp /home/3rd-party/boost/lib/libboost_filesystem.so.1.55.0 ${WORKSPACE}/lib
cp /home/3rd-party/boost/lib/libboost_system.so.1.55.0 ${WORKSPACE}/lib
cp /home/3rd-party/boost/lib/libboost_thread.so.1.55.0 ${WORKSPACE}/lib
cp /home/3rd-party/boost/lib/libboost_regex.so.1.55.0 ${WORKSPACE}/lib
cp /home/3rd-party/boost/lib/libboost_program_options.so.1.55.0 ${WORKSPACE}/lib
cp /home/3rd-party/libevent-2.0.21/lib/libevent-2.0.so.5 ${WORKSPACE}/lib
cp /home/3rd-party/json-c-0.9/lib/libjson.so.0 ${WORKSPACE}/lib
cp /home/3rd-party/poco/lib/libPocoFoundation.so.16 ${WORKSPACE}/lib
cp /home/3rd-party/poco/lib/libPocoDataMySQL.so.16 ${WORKSPACE}/lib
cp /home/3rd-party/poco/lib/libPocoData.so.16 ${WORKSPACE}/lib
cp /lib64/libssl.so.6 ${WORKSPACE}/lib
cp /usr/lib64/mysql/libmysqlclient.so.15 ${WORKSPACE}/lib

echo build date $1
tar -cjf accessServer${1}.tar.bz2 -C ${WORKPATH} accessServer

echo 'end'

