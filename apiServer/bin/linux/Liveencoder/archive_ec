BASH=/bin/bash

echo 'start'

WORKPATH=/tmp/${USER}

mkdir -p ${WORKPATH}
rm -rf ${WORKPATH}/encoder

mkdir ${WORKPATH}/encoder
mkdir ${WORKPATH}/encoder/bin
mkdir ${WORKPATH}/encoder/config
mkdir ${WORKPATH}/encoder/lib
mkdir ${WORKPATH}/encoder/doc

cp -rf bin/liveencoder ${WORKPATH}/encoder/bin/
cp -rf config/log.property ${WORKPATH}/encoder/config/
cp -rf config/ec.cfg ${WORKPATH}/encoder/config/sys.cfg
cp -rf check_exist.sh ${WORKPATH}/encoder/check_exist.sh
cp -rf doc/*.docx ${WORKPATH}/encoder/doc

cp -rf /home/3rd-party/ffmpeg ${WORKPATH}/encoder
cp /home/3rd-party/boost/lib/libboost_system.so.1.55.0 ${WORKPATH}/encoder/lib
cp /home/3rd-party/boost/lib/libboost_filesystem.so.1.55.0 ${WORKPATH}/encoder/lib
cp /home/3rd-party/boost/lib/libboost_thread.so.1.55.0 ${WORKPATH}/encoder/lib
cp /home/3rd-party/boost/lib/libboost_program_options.so.1.55.0 ${WORKPATH}/encoder/lib
cp /home/3rd-party/poco/lib/libPocoFoundation.so.16 ${WORKPATH}/encoder/lib
cp /home/3rd-party/log4cxx/lib/liblog4cxx.so.10 ${WORKPATH}/encoder/lib
cp /home/3rd-party/json-c-0.9/lib/libjson.so.0 ${WORKPATH}/encoder/lib
cp /home/3rd-party/libevent-2.0.21/lib/libevent-2.0.so.5 ${WORKPATH}/encoder/lib
cp /usr/lib64/libaprutil-1.so.0 ${WORKPATH}/encoder/lib
cp /usr/lib64/libapr-1.so.0 ${WORKPATH}/encoder/lib


echo build date $1
tar -cjf encoder${1}.tar.bz2 -C ${WORKPATH} encoder

echo 'end'

